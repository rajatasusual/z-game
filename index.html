<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6200ea"> <!-- Matches your PWA's theme -->
    <title>Z</title>
    <!-- Include Google Fonts for Material Design -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Link to your Material-styled CSS -->
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="/manifest.json">
</head>

<body>
    <button id="install-pwa" style="display: none;">Install</button>
    <div class="game-container">
        <img src="icons/z.png" alt="Z" class="md-logo">

        <!-- Score Display -->
        <div id="score" class="md-card md-score">Score: 0</div>

        <!-- Game Board -->
        <div id="board" class="md-board"></div>

        <!-- Collapsible Game Rules -->
        <h2 class="md-subtitle">Game Rules</h2>
        <details class="md-rules-container">
            <summary class="md-rules-summary">View Game Rules</summary>
            <ul class="md-rules">
                <li>The goal is to combine letters by sliding them in any direction.</li>
                <li>Two tiles with the same letter combine into the next letter (e.g., A + A = B).</li>
                <li>Vowels have orange shades, consonants have distinct colors.</li>
                <li>Earn points for forming valid 4-letter words based on the Scrabble point system.</li>
                <li>Earn points for combining vowels (+2) and incur a penalty for consonants (-1).</li>
                <li>No movement during a turn results in a -1 point penalty.</li>
                <li>New letters will appear on the board after a valid move.</li>
                <li>Form horizontal or vertical 4-letter words for bonus points.</li>
                <li>Matched words will disappear, and the grid will shift to fill the gaps.</li>
            </ul>
        </details>

        <!-- Reset Game Button -->
        <button class="md-button" id="reset-game">Reset Game</button>
    </div>

    <!-- Link to your game logic scripts -->
    <script src="init.js"></script>
    <script src="service-worker.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('ServiceWorker registration failed: ', registrationError);
                    });
            });
        }

        let deferredPrompt;

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;

            // Show your own custom install prompt (e.g., a button)
            const installButton = document.getElementById('install-pwa');
            installButton.style.display = 'block';

            installButton.addEventListener('click', () => {
                // Show the install prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the PWA installation');
                    }
                    deferredPrompt = null;
                });
            });
        });
    </script>
    <script src="game.js" type="module"></script>
    <script src="ui.js" type="module"></script>
</body>

</html>